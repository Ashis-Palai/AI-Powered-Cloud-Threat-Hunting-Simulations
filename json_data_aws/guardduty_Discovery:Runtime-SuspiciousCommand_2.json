{
  "accountId": "123456789012",
  "arn": "arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/rs7890aa1122bb3344ccddeeff001122",
  "createdAt": "2025-12-14T10:44:58.214Z",
  "id": "rs7890aa1122bb3344ccddeeff001122",
  "region": "us-east-1",
  "schemaVersion": "2.0",
  "severity": 6.5,
  "type": "Discovery:Runtime/SuspiciousCommand",
  "updatedAt": "2025-12-14T10:44:58.214Z",
  "confidence": 0.79,
  "partition": "aws",
  "title": "Suspicious cloud discovery commands executed in runtime workload",
  "description": "Following access to the container metadata service, the runtime workload executed AWS CLI commands to enumerate identity, permissions, and cloud resources, indicating post-compromise discovery activity.",
  "associatedAttackSequenceArn": "arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210",

  "resource": {
    "resourceType": "Container",
    "containerDetails": {
      "containerRuntime": "containerd",
      "id": "9f3c2a1b7d8e4f56a0c123456789abcd",
      "image": "public.ecr.aws/nginx/nginx:1.25",
      "imagePrefix": "public.ecr.aws/nginx",
      "name": "webapp-backend",
      "securityContext": {
        "allowPrivilegeEscalation": true,
        "privileged": true
      },
      "volumeMounts": [
        {
          "mountPath": "/var/run/docker.sock",
          "name": "docker-socket"
        }
      ]
    }
  },

  "service": {
    "serviceName": "GuardDuty",
    "featureName": "Runtime Monitoring",
    "detectorId": "12abc34d567e8fa901bc2d34e56789ab",
    "archived": false,
    "count": 4,
    "eventFirstSeen": "2025-12-14T10:44:48.902Z",
    "eventLastSeen": "2025-12-14T10:44:57.991Z",
    "resourceRole": "TARGET",

    "runtimeDetails": {
      "context": {
        "commandLineExample": "aws sts get-caller-identity; aws iam simulate-custom-policy --policy-input-list '{\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"s3:ListBucket\"],\"Resource\":[\"*\"]}]}'; aws s3 ls; aws secretsmanager list-secrets",
        "toolCategory": "Discovery",
        "toolName": "AWS CLI Cloud Enumeration"
      },

      "process": {
        "name": "aws",
        "executablePath": "/usr/bin/aws",
        "pid": 476,
        "namespacePid": 476,
        "uuid": "proc-awscli-6e2c9d81",
        "parentUuid": "proc-shell-92fd7c1a",
        "pwd": "/",
        "startTime": "2025-12-14T10:44:48.741Z",
        "user": "www-data",
        "userId": 33,
        "euid": 33,

        "lineage": [
          {
            "name": "sh",
            "executablePath": "/bin/sh",
            "pid": 438,
            "namespacePid": 438,
            "uuid": "proc-shell-92fd7c1a",
            "parentUuid": "proc-python3-b81f9a6d",
            "startTime": "2025-12-14T10:42:31.887Z",
            "userId": 33,
            "euid": 33
          },
          {
            "name": "python3",
            "executablePath": "/usr/bin/python3",
            "pid": 421,
            "namespacePid": 421,
            "uuid": "proc-python3-b81f9a6d",
            "startTime": "2025-12-14T10:41:51.902Z",
            "userId": 33,
            "euid": 33
          }
        ]
      }
    }
  }
}
