{
  "accountId": "123456789012",
  "arn": "arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/pe1122bb3344ccddeeff556677889900",
  "createdAt": "2025-12-14T10:45:22.614Z",
  "id": "pe1122bb3344ccddeeff556677889900",
  "region": "us-east-1",
  "schemaVersion": "2.0",
  "severity": 8.2,
  "type": "PrivilegeEscalation:Runtime/DockerSocketAccessed",
  "updatedAt": "2025-12-14T10:45:22.614Z",
  "confidence": 0.91,
  "partition": "aws",
  "title": "Docker socket accessed by a runtime workload",
  "description": "A runtime workload accessed the Docker daemon socket, indicating a potential attempt to escalate privileges by interacting directly with the container runtime on the host.",
  "associatedAttackSequenceArn": "arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210",

  "resource": {
    "resourceType": "Container",
    "containerDetails": {
      "containerRuntime": "containerd",
      "id": "9f3c2a1b7d8e4f56a0c123456789abcd",
      "image": "public.ecr.aws/nginx/nginx:1.25",
      "imagePrefix": "public.ecr.aws/nginx",
      "name": "webapp-backend",
      "securityContext": {
        "allowPrivilegeEscalation": true,
        "privileged": true
      },
      "volumeMounts": [
        {
          "mountPath": "/var/run/docker.sock",
          "name": "docker-socket"
        }
      ]
    }
  },

  "service": {
    "serviceName": "GuardDuty",
    "featureName": "Runtime Monitoring",
    "detectorId": "12abc34d567e8fa901bc2d34e56789ab",
    "archived": false,
    "count": 1,
    "eventFirstSeen": "2025-12-14T10:45:12.083Z",
    "eventLastSeen": "2025-12-14T10:45:21.944Z",
    "resourceRole": "TARGET",

    "runtimeDetails": {
      "context": {
        "commandLineExample": "curl -X POST --unix-socket /var/run/docker.sock http://localhost/containers/create",
        "toolCategory": "PrivilegeEscalation",
        "toolName": "Docker Remote API",
        "socketPath": "/var/run/docker.sock"
      },

      "process": {
        "name": "curl",
        "executablePath": "/usr/bin/curl",
        "pid": 512,
        "namespacePid": 512,
        "uuid": "proc-curl-dockersock-4a7c2e19",
        "parentUuid": "proc-shell-92fd7c1a",
        "pwd": "/",
        "startTime": "2025-12-14T10:45:11.774Z",
        "user": "www-data",
        "userId": 33,
        "euid": 33,

        "lineage": [
          {
            "name": "sh",
            "executablePath": "/bin/sh",
            "pid": 438,
            "namespacePid": 438,
            "uuid": "proc-shell-92fd7c1a",
            "parentUuid": "proc-python3-b81f9a6d",
            "startTime": "2025-12-14T10:42:31.887Z",
            "userId": 33,
            "euid": 33
          },
          {
            "name": "python3",
            "executablePath": "/usr/bin/python3",
            "pid": 421,
            "namespacePid": 421,
            "uuid": "proc-python3-b81f9a6d",
            "startTime": "2025-12-14T10:41:51.902Z",
            "userId": 33,
            "euid": 33
          }
        ]
      }
    }
  }
}
