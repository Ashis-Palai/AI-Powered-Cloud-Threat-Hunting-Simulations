{
  "accountId": "123456789012",
  "arn": "arn:aws:guardduty:us-east-1:123456789012:detector/12abc34d567e8fa901bc2d34e56789ab/finding/md4567ab8901ccde2345ff6677889900",
  "createdAt": "2025-12-14T10:42:55.642Z",
  "id": "md4567ab8901ccde2345ff6677889900",
  "region": "us-east-1",
  "schemaVersion": "2.0",
  "severity": 7.1,
  "type": "UnauthorizedAccess:Runtime/MetadataDNSRebind",
  "updatedAt": "2025-12-14T10:42:55.642Z",
  "confidence": 0.84,
  "partition": "aws",
  "title": "Container attempted access to runtime metadata endpoint",
  "description": "A process running inside a container attempted to access a runtime metadata endpoint, which may indicate an attempt to enumerate or harvest credentials and task metadata following a compromise.",
  "associatedAttackSequenceArn": "arn:aws:guardduty:us-east-1:123456789012:attack-sequence/seq-9f8e7d6c5b4a3210",

  "resource": {
    "resourceType": "Container",
    "containerDetails": {
      "containerRuntime": "containerd",
      "id": "9f3c2a1b7d8e4f56a0c123456789abcd",
      "image": "public.ecr.aws/nginx/nginx:1.25",
      "imagePrefix": "public.ecr.aws/nginx",
      "name": "webapp-backend",
      "securityContext": {
        "allowPrivilegeEscalation": true,
        "privileged": true
      },
      "volumeMounts": [
        {
          "mountPath": "/var/run/docker.sock",
          "name": "docker-socket"
        }
      ]
    }
  },

  "service": {
    "serviceName": "GuardDuty",
    "featureName": "Runtime Monitoring",
    "detectorId": "12abc34d567e8fa901bc2d34e56789ab",
    "archived": false,
    "count": 2,
    "eventFirstSeen": "2025-12-14T10:42:50.642Z",
    "eventLastSeen": "2025-12-14T10:42:54.642Z",
    "resourceRole": "TARGET",

    "action": {
      "actionType": "NETWORK_CONNECTION",
      "networkConnectionAction": {
        "blocked": false,
        "connectionDirection": "OUTBOUND",
        "protocol": "TCP",
        "localNetworkInterface": "eth0",

        "localIpDetails": {
          "ipAddressV4": "169.254.170.2"
        },

        "localPortDetails": {
          "port": 41876,
          "portName": "ephemeral"
        },

        "remoteIpDetails": {
          "ipAddressV4": "169.254.170.2"
        },

        "remotePortDetails": {
          "port": 80,
          "portName": "http"
        }
      }
    },

    "runtimeDetails": {
      "context": {
        "addressFamily": "AF_INET",
        "ianaProtocolNumber": 6,
        "commandLineExample": "curl $ECS_CONTAINER_METADATA_URI_V4/task; curl http://169.254.170.2$AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",
        "toolCategory": "Credential Access",
        "toolName": "ECS Container Metadata Endpoint Access"
      },

      "process": {
        "name": "curl",
        "executablePath": "/usr/bin/curl",
        "pid": 452,
        "namespacePid": 452,
        "uuid": "proc-curl-4f3a9b21",
        "parentUuid": "proc-shell-92fd7c1a",
        "startTime": "2025-12-14T10:43:44.887Z",
        "user": "www-data",
        "userId": 33,
        "euid": 33,

        "lineage": [
          {
            "name": "sh",
            "executablePath": "/bin/sh",
            "pid": 438,
            "namespacePid": 438,
            "uuid": "proc-shell-92fd7c1a",
            "parentUuid": "proc-python3-b81f9a6d",
            "startTime": "2025-12-14T10:42:31.887Z",
            "userId": 33,
            "euid": 33
          },
          {
            "name": "python3",
            "executablePath": "/usr/bin/python3",
            "pid": 421,
            "namespacePid": 421,
            "uuid": "proc-python3-b81f9a6d",
            "startTime": "2025-12-14T10:41:51.902Z",
            "userId": 33,
            "euid": 33
          }
        ]
      }
    }
  }
}
